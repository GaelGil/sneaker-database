<%- contentFor('title') %>
<%- contentFor('body') %>


<div class="container">
    <h1><%= snkr.sneakerName %> </h1>
    <img style="width:18rem;" src="<%= snkr.imageUrl %>">
    <canvas id="barChart" width="200" height="200"></canvas>
    <canvas id="lineChart" width="200" height="200"></canvas>
  
</div>


<!-- for getting data -->
<div style="display:none" class="blog_section">
    <% for (let sneaker of sneakers) { %>
        <% if (snkr.styleID == sneaker.styleID) { %>
            
    <p class="releaseDate data" id="releaseDate" data="<%= sneaker.releaseDate %>"><%= sneaker.releaseDate %></p>
    <p class="name data" id="name" data="<%= sneaker.sneakerName %>"><%= sneaker.sneakerName %> </p>
    <p class="price retail data" id="retail" data="<%= sneaker.retailPrice %>"><%= sneaker.retailPrice %></p>
    <p class="price stockx data" id="stockx" data="<%= sneaker.stockXPrice %>"><%= sneaker.stockXPrice %></p>
    <p class="price goat data" id="goat" data="<%= sneaker.goatPrice %>"><%= sneaker.goatPrice %></p>
    <p class="price stadium data" id="stadium" data="<%= sneaker.stadiumGoodsPrice %>"><%= sneaker.stadiumGoodsPrice %></p>
    <p class="price flight data" id="flight" data="<%= sneaker.flightClubPrice %>"><%= sneaker.flightClubPrice %></p>
    <p class="date data" id="date" data="<%= sneaker.createdAt %>"><%= sneaker.createdAt %></p>

            <% } %>

    <% } %>
  </div>
<!-- end get data -->


  <script>

    let allData = []

    // get all data into a list of dictionaries
    let dataClass = document.getElementsByTagName("p");
    for (let i = 0; i < dataClass.length; i++){
        let name = "";
        let releaseDate = "";
        let retail = 0;
        let stockx = 0;
        let stadium = 0;
        let flight = 0;
        let date = 0;
        let avg = 0;

        if ($('p').hasClass("name")){
            name = $('#name').first().text();
        }
        

        if ($('p').hasClass("releaseDate")){
            releaseDate = $('#releaseDate').first().text();
        }
        

        // all the prices
        if ($('p').hasClass("retail")){
            retail =  parseInt($('#retail').first().text());
        }


        if ($('p').hasClass("stockx")){
            stockx =  parseInt($('#stockx').first().text());
        }


        if ($('p').hasClass("goat")){
            goat =  parseInt($('#goat').first().text());
        }


        if ($('p').hasClass("stadium")){
            stadium =  parseInt($('#stadium').first().text());
        }

        if ($('p').hasClass("flight")){
           flight =  parseInt($('#flight').first().text());
        }

        // the date
        if ($('p').hasClass("date")){
           date = $('#date').first().text();
        }

        avg = (stockx+goat+stadium+flight)/4;
        
        allData.push({
            "releaseDate": releaseDate,
            "name": name,
            "retail": retail,
            "stockx": stockx,
            "goat": goat,
            "stadium": stadium,
            "flight": flight,
            "date": date,
            "average": avg,
        })
    }


    let dataByReseller = []

    for (let i = 0; i <allData.length;i++){

        let totalRetailPrice = 0;

        var totalStockxPrice = 0;
                
        var totalGoatPrice = 0;

        var totalStadiumPrice = 0;

        var totalFlightPrice = 0;

        var totalAveragePrice = 0;
        
        totalStockxPrice = allData[i].stockx;
        
        totalGoatPrice = allData[i].goat;

        totalStadiumPrice = allData[i].stadium;

        totalFlightPrice = allData[i].flight;

        totalAveragePrice = allData[i].average;
    }


    dataByReseller.push({
            "id": 0,
            "place": "retail",
            "price": allData[0].retail,
        })

        dataByReseller.push({
            "id": 1,
            "place": "stockx",
            "price": totalStockxPrice

        })


        dataByReseller.push({
            "id": 2,
            "place": "goat",
            "price": totalGoatPrice
        })


        dataByReseller.push({
            "id": 3,
            "place": "stadium",
            "price": totalStadiumPrice
        })

        dataByReseller.push({
            "id": 4,
            "place": "flight",
            "price": totalFlightPrice
        })


        dataByReseller.push({
            "id": 5,
            "place": "average",
            "price": totalAveragePrice
        })



// create labeles
let barChartLabels = [];
barChartLabels.push("retail");
barChartLabels.push("goat");
barChartLabels.push("stockx");
barChartLabels.push("stadium");
barChartLabels.push("flight");
barChartLabels.push("average");

// get char data
let barChartData = [];
for (let i = 0; i < dataByReseller.length; i++){
    barChartData.push(dataByReseller[i].price);
}


let months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC']


let dataByDay = []
console.log(allData[0].date)
console.log(allData[1].date)
console.log(allData[2].date)
console.log(allData[3].date)
console.log(allData[4].date)

for (let i = 0; i < allData.length; i++){
    allData[i]

}


// get words in string into lists of words
// find words month 
// create date ie month/day/year
// create list with price and date
//

var ctx = document.getElementById('barChart');
ctx.height = 300;
ctx.width = 300;

var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: barChartLabels,
        datasets: [{
            label: 'price in US dollars',
            data: barChartData,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        responsive: false,
        // maintainAspectRatio: true,
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var linectx = document.getElementById('lineChart');
var stackedLine = new Chart(linectx, {
    type: 'line',
    data: {
        labels: barChartLabels,
        datasets: [{
            label: 'price',
            fill: false,
            data: barChartData,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },    options: {

        scales: {
            yAxes: [{
                stacked: true
            }]
        }
    }
});


</script>




